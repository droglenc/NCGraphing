---
layout: page
title: Exercise - Deer Harvest
author: Derek H. Ogle
css: "/css/modules.css"
output:
  html_document:
    self_contained: false
    lib_dir: zlibs
---

```{r echo=FALSE, eval=FALSE}
# Renders an appropriate HTML file for the webpage (CTRL-S and CTRL-ALT-C)
source(file.path(here::here(),"rhelpers/rhelpers.R"))
fnm <- "CE_DeerHarvest"
dnm <- "modules/Means"
modHTML(file.path(here::here(),dnm,fnm))
FSA::purl2(file.path(here::here(),dnm,paste0(fnm,".Rmd")),
           moreItems=c("source","setwd","fnm","dnm","opts_chunk","CTRL-S"))
```
```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, fig.width=5, fig.height=5,out.width="60%")
library(tidyverse)
```

----

## Background
<img src="../zimgs/Deer.jpg" alt="Deer" class="img-right">
Deer hunting is ingrained in the culture and is big business in northern Wisconsin. Thus, management of the Whitetail Deer (**) populations in this area is an important issue. Harvest rules and recommendations are based on recommendations from the Department of Natural Resources (DNR) and the County Deer Advisory Councils (CDACs), which are made up of local citizents, to the Natural Resources Board. One piece of evidence used in these recommendations are past harvest statistics. The harvest of deer from Douglas, Bayfield, Ashland, and Iron Counties, the northern-most tier of couties in Wisconsin, from 2010-2019 were recorded in the [DeerHarvest.csv file](https://raw.githubusercontent.com/droglenc/NCData/master/DeerHarvest.csv), with [these metadata](https://raw.githubusercontent.com/droglenc/NCData/master/DeerHarvest_meta.txt).

```{r echo=TRUE, results='hide'}
#!# Set to your own working directory and have just your filename below.
dh <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/DeerHarvest.csv")
str(dh)
cbbPalette <- c("#000000","#E69F00","#56B4E9","#009E73",
                "#F0E442","#0072B2","#D55E00","#CC79A7")
```

&nbsp;

## Total Annual Harvest by County 1
Construct `ggplot2` code to match the graph below (as closely as you can).

```{r Harvest_1}
harv1 <- ggplot(data=dh,mapping=aes(x=County,y=Ttl.All)) +
  stat_summary(fun=mean,geom="bar",alpha=0.75) +
  stat_summary(fun.data=mean_cl_normal,geom="errorbar",width=0.1) +
  scale_x_discrete(name="County") +
  scale_y_continuous(name="Mean Total Annual Deer Harvest",
                     expand=expansion(mult=c(0,0.05))) +
  theme_bw() +
  theme(panel.grid.major.x=element_blank())
harv1
```

&nbsp;


## Total Annual Harvest by County 2
Construct `ggplot2` code to match the graph below (as closely as you can). *Note, I don't recommend this superfluous use of color, but I do want to see if you can figure out how to make it.*

```{r Harvest_2}
harv2 <- ggplot(data=dh,mapping=aes(x=County,y=Ttl.All,
                                    fill=County,color=County)) +
  stat_summary(fun=mean,geom="bar",alpha=0.5) +
  stat_summary(fun.data=mean_cl_normal,geom="errorbar",width=0.1) +
  scale_x_discrete(name="County") +
  scale_y_continuous(name="Mean Total Annual Deer Harvest",
                     expand=expansion(mult=c(0,0.05))) +
  scale_fill_manual(values=cbbPalette) +
  scale_color_manual(values=cbbPalette) +
  theme_bw() +
  theme(panel.grid.major.x=element_blank(),
        legend.position="none")
harv2
```

&nbsp;

## Total Annual Harvest by County 3
Construct `ggplot2` code to match the graph below (as closely as you can). *Hint: If you saved your plot from the previous section, you should be able to create this plot by "adding" three functions of code to the saved ggplot object.*

```{r Harvest_3}
harv3 <- harv2 +
  coord_flip() +
  scale_x_discrete(name=element_blank()) +
  theme(panel.grid.major.y=element_blank())
harv3
```

&nbsp;

## Total Annual Harvest by County 4
Construct `ggplot2` code to match the graph below (as closely as you can). *Hint: If you saved your plot from the previous section, you should be able to create this plot by "adding" one function of code to the saved ggplot object.*

```{r Harvest_4}
harv4 <- harv3 +
  geom_jitter(width=0.1)
harv4
```

&nbsp;

## Total Annual Harvest by County and Year
Construct `ggplot2` code to match the graph below (as closely as you can). *Note, I don't recommend this superfluous use of color, but I do want to see if you can figure out how to make it.*

```{r Harvest_5, fig.width=6.5}
harv5 <- ggplot(data=dh,mapping=aes(x=Year,y=Ttl.All,color=County)) +
  geom_point(alpha=0.25) +
  geom_line() +
  scale_x_continuous(name="Year",breaks=seq(2010,2018,2)) +
  scale_y_continuous(name="Total Annual Deer Harvest",
                     expand=expansion(mult=c(0,0.05)),
                     limits=c(0,8000)) +
  scale_fill_manual(values=cbbPalette) +
  scale_color_manual(values=cbbPalette) +
  theme_bw()
harv5
```
