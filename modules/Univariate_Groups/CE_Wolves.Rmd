---
layout: page
title: Exercise - Wolves
author: Derek H. Ogle
css: "/css/modules.css"
output:
  html_document:
    self_contained: false
    lib_dir: zlibs
---

```{r echo=FALSE, eval=FALSE}
# Renders an appropriate HTML file for the webpage (CTRL-S and CTRL-ALT-C)
source(file.path(here::here(),"rhelpers/rhelpers.R"))
fnm <- "CE_Wolves"
dnm <- "modules/Univariate_Groups"
modHTML(file.path(here::here(),dnm,fnm))
FSA::purl2(file.path(here::here(),dnm,paste0(fnm,".Rmd")),
           moreItems=c("source","setwd","fnm","dnm","opts_chunk","CTRL-S"))
```
```{r echo=FALSE}
knitr::opts_chunk$set(echo=FALSE,fig.width=5,fig.height=5,out.width="60%")
```

----

## Background
Dr. Kevin Schanning used a mail survey designed to measure Michigan, Minnesota, and Wisconsin residentsâ€™ feelings, attitudes, experiences with, concerns about management techniques, and knowledge of wolves specific to their state. The survey was 13 pages long, in booklet form, and consisted of 220 questions divided among eight sections: experience with wolves, activities, safety concerns, attitudes, knowledge of wolves in their state, management issues, background (demographics), and how they get their information about wolves. Schanning's data was recorded in [StateOfWolf.csv](https://raw.githubusercontent.com/droglenc/NCData/master/StateOfWolf.csv).

These data are loaded below and reduced to many fewer variables (use of `select()`) and only those respondents that answered all of those questions (use of `complete.cases()` within `filter()`) to reduce the overall size of the data.frame in R. In addition, for the purposes of this exercise, the data.frame was reduced to only those respondents that deer hunted the previous year (i.e., the last `filter()`). Several variables were converted to groupings with the levels controlled to a proper order (i.e., `levels=` within `factor()` within `mutate()`).[^copycode]

```{r echo=TRUE, results="hide", message=FALSE, warning=FALSE}
library(tidyverse)
lvls_agree <- c("Strongly Disagree","Disagree","Neutral","Agree","Strongly Agree")

#!# Set to your own working directory and have just your filename below.
sow <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/StateOfWolf.csv") %>%
  select(state,hunt_deer,seen_wolf,part_deer,
         ad_healthy_deer,ad_nowolves_deer,ad_threaten_deer,ad_deer_hunting) %>%
  filter(complete.cases(.)) %>%
  mutate(part_deer=factor(part_deer,
          levels=c("Stop Participating","Participate Less Frequently",
                   "Participate More Frequently","No Changes")),
         ad_healthy_deer=factor(ad_healthy_deer,levels=lvls_agree),
         ad_nowolves_deer=factor(ad_nowolves_deer,levels=lvls_agree),
         ad_threaten_deer=factor(ad_threaten_deer,levels=lvls_agree),
         ad_deer_hunting=factor(ad_deer_hunting,levels=lvls_agree)) %>%
  filter(hunt_deer=="Yes")
```

The specific questions with respect to the variable names are as follows:

* `state`: Resident's state of residence.
* `hunt_deer`: Whether or not the respondent hunted deer the previous year (should all be `Yes`).
* `seen_wolf`: Whether or not the respondent has ever seen a wolf.
* `part_deer`: Respondent's answer to the question "If I knew wolves lived where I participated in deer hunting, I would ['Stop Participating', 'Participate Less Frequently', 'Participate More Frequently', or make 'No Changes']."
* `ad_healthy_deer`: Respondent's answer to the question "State your level of agreement with the statement 'Wolves help keep deer herds healthy by killing the sick and the weak animals'."
* `ad_nowolves_deer`: Respondent's answer to the question "State your level of agreement with the statement 'I think the elimination of wolves from most of the United States has resulted in overabundant and unhealthy deer populations in many places'."
* `ad_threaten_deer`: Respondent's answer to the question "State your level of agreement with the statement 'The state's wolf population threatens deer hunting opportunities'."
* `ad_deer_hunting`: Respondent's answer to the question "State your level of agreement with the statement 'There is no way sportsmen can have good deer hunting if wolves live in the same area'."

&nbsp;

## No Good Deer Hunting 1
Construct `ggplot2` code to match the graph below (as closely as you can).

```{r Wolves_NGDH1}
ngdh1 <- ggplot(data=sow,mapping=aes(x=ad_deer_hunting)) +
  geom_bar(color="gray30",fill="wheat") +
  scale_x_discrete(name="Level of Agreement") +
  scale_y_continuous(name="Frequency of Respondents",
                     expand=expansion(mult=c(0,0.05))) +
  theme_bw() +  
  theme(panel.grid.major.x=element_blank(),panel.grid.minor.x=element_blank())
ngdh1
```

&nbsp;

## State and No Good Deer Hunting 1
Construct `ggplot2` code to match the graph below (as closely as you can ... *you don't have to match my colors, but do use other than the default colors*).

```{r Wolves_NGDHState1, fig.width=6.5, out.width="75%"}
NGDHst1 <- ggplot(data=sow,mapping=aes(x=state,fill=ad_deer_hunting)) +
  geom_bar(color="gray30",alpha=0.7) +
  scale_x_discrete(name="State") +
  scale_y_continuous(name="Frequency of Respondents",
                     expand=expansion(mult=c(0,0.05))) +
  scale_fill_manual(name="Agreement",
                    values=c("#E69F00","#56B4E9","#009E73","#F0E442","#0072B2")) +
  theme_bw() +  
  theme(panel.grid.major.x=element_blank(),panel.grid.minor.x=element_blank())
NGDHst1
```

&nbsp;

## State and No Good Deer Hunting 2
Construct `ggplot2` code to match the graph below (as closely as you can).

```{r Wolves_NGDHState2, fig.width=6.5, out.width="75%"}
NGDHst2 <- ggplot(data=sow,mapping=aes(x=state,fill=ad_deer_hunting)) +
  geom_bar(color="gray30",alpha=0.7) +
  scale_x_discrete(name="State") +
  scale_y_continuous(name="Frequency of Respondents",
                     expand=expansion(mult=c(0,0.05))) +
  scale_fill_manual(name="Agreement",
                    values=c("#E69F00","#56B4E9","#009E73","#F0E442","#0072B2")) +
  coord_flip() +
  theme_bw() +  
  theme(panel.grid.major.x=element_blank(),panel.grid.minor.x=element_blank())
NGDHst2
```

&nbsp;

## No Good Deer Hunting 2
Recreate the plot in the "Region 1" section but using summarized data (*i.e., summarize the data first and then use that to construct the plot*).

```{r Wolves_NGDH2, fig.show='hide'}
sum1 <- sow %>%
  group_by(ad_deer_hunting) %>%
  summarize(freq=n()) %>%
  ungroup()

ngdh2 <- ggplot(data=sum1,mapping=aes(x=ad_deer_hunting,y=freq)) +
  geom_bar(stat="identity",color="gray30",fill="wheat") +
  scale_x_discrete(name="Level of Agreement") +
  scale_y_continuous(name="Frequency of Respondents",
                     expand=expansion(mult=c(0,0.05))) +
  theme_bw() +  
  theme(panel.grid.major.x=element_blank(),panel.grid.minor.x=element_blank())
ngdh2
```

&nbsp;

## State and No Good Deer Hunting 3
Recreate the plot in "State and No Good Deer Hunting 2" using summarized data. [*Hint: you will be asked to use percentages in the next section, so you should prepare your summaries here for that*.]

```{r Wolves_NGDHState3, fig.show='hide'}
sum2 <- sow %>%
  group_by(state,ad_deer_hunting) %>%
  summarize(freq=n()) %>%
  mutate(perc=freq/sum(freq)*100) %>%
  ungroup()
  
NGDHst3 <- ggplot(data=sum2,mapping=aes(x=state,y=freq,fill=ad_deer_hunting)) +
  geom_bar(stat="identity",color="gray30",alpha=0.7) +
  scale_x_discrete(name="State") +
  scale_y_continuous(name="Frequency of Respondents",
                     expand=expansion(mult=c(0,0.05))) +
  scale_fill_manual(name="Agreement",
                    values=c("#E69F00","#56B4E9","#009E73","#F0E442","#0072B2")) +
  coord_flip() +
  theme_bw() +  
  theme(panel.grid.major.x=element_blank(),panel.grid.minor.x=element_blank())
NGDHst3
```

&nbsp;

## State and No Good Deer Hunting 4
Construct `ggplot2` code to match the graph below (as closely as you can).

```{r Wolves_NGDHState4, fig.width=6.5, out.width="75%"}
NGDHst4 <- ggplot(data=sum2,mapping=aes(x=state,y=perc,fill=ad_deer_hunting)) +
  geom_bar(stat="identity",color="gray30",alpha=0.7) +
  scale_x_discrete(name="State") +
  scale_y_continuous(name="Percent of Respondents",
                     expand=expansion(mult=0)) +
  scale_fill_manual(name="Agreement",
                    values=c("#E69F00","#56B4E9","#009E73","#F0E442","#0072B2")) +
  coord_flip() +
  theme_bw() +  
  theme(panel.grid.major.x=element_blank(),panel.grid.minor.x=element_blank())
NGDHst4
```

&nbsp;

### Footnote
[^copycode]: These code can be copied as is, but make sure to set your working directory with `setwd()` and to put just the filename inside `read.csv()`.
